<style>
body.overlay .container { display: none }
body.overlay {
  display: flex;
  font-size: 60px;
  height: 100vh;
  align-items: center;
  justify-content: center;
}
body.overlay::before {
  content: "Click to start";
}
.container {
  display: flex;
}
video { width: calc(100vw - 8px);position:absolute;left:0px;top:0px;}
</style>
<body onload="init()">
<div class="container">
<script>
function init(){
	document.body.classList.add("overlay");
	onclick = async () => {
		document.body.classList.remove("overlay");
	  const delay = 3;
	  const mimeType = `video/webm; codecs="vp8"`;
	  const stream = await getStream();
	  document.getElementById("realtime").srcObject = stream;
	  
	  const mediaSource = new MediaSource();
	  const mediaSource2 = new MediaSource();
	  
	  const delayed = document.getElementById("delayed");
	  const delayed2 = document.getElementById("delayed2");
	  delayed.src = URL.createObjectURL(mediaSource);
	  delayed2.src = URL.createObjectURL(mediaSource2);
	  
	  await new Promise((res) =>
		mediaSource.addEventListener("sourceopen", res, { once: true })
	  );
	  await new Promise((res) =>
		mediaSource2.addEventListener("sourceopen", res, { once: true })
	  );
	  
	  const sourceBuffer = mediaSource.addSourceBuffer(mimeType);
	  const sourceBuffer2 = mediaSource2.addSourceBuffer(mimeType);
	  const recorder = new MediaRecorder(stream, { mimeType });
	  const recorder2 = new MediaRecorder(stream, { mimeType });
	  const chunks = [];
	  recorder.ondataavailable = async ({ data }) => {
		if (mediaSource.readyState !== "open" || !data.size) {
		  return;
		}
		sourceBuffer.appendBuffer(await data.arrayBuffer());
	  }; 
	  const chunks2 = [];
	  recorder2.ondataavailable = async ({ data }) => {
		if (mediaSource2.readyState !== "open" || !data.size) {
		  return;
		}
		sourceBuffer2.appendBuffer(await data.arrayBuffer());
	  };
	  
	  delayed.pause();
	  delayed2.pause();
	  recorder.start(50);
	  recorder2.start(50);
	  delayed2.play();
	  ;
	  setTimeout(() => delayed.play(), 300);
	}
}

function getStream() {
  return navigator.mediaDevices.getUserMedia({ video: true });
}
</script>
  <section style="position:absolute;left:0px;top:0px;display:none">
    <video id="realtime" autoplay muted controls></video>
  </section>
  <section style="">
    <video id="delayed2" autoplay muted controls style=""></video>
    <video id="delayed" autoplay muted controls style="filter: opacity(50%) invert();"></video>
  </section>
</div>
</body>