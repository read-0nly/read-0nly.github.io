<style>
body.overlay .container { display: none }
body.overlay {
  display: flex;
  font-size: 60px;
  height: 100vh;
  align-items: center;
  justify-content: center;
}
body.overlay::before {
  content: "Click to start";
}
.container {
  display: flex;
}
video { width: calc(100vw - 8px);}
</style>
<script>
document.body.classList.add("overlay");
onclick = async () => {
	document.body.classList.remove("overlay");
  const delay = 3;
  const mimeType = `video/webm; codecs="vp8"`;
  const stream = await getStream();
  document.getElementById("realtime").srcObject = stream;
  const mediaSource = new MediaSource();
  const delayed = document.getElementById("delayed");
  delayed.src = URL.createObjectURL(mediaSource);
  await new Promise((res) =>
    mediaSource.addEventListener("sourceopen", res, { once: true })
  );
  const sourceBuffer = mediaSource.addSourceBuffer(mimeType);
  const recorder = new MediaRecorder(stream, { mimeType });
  const chunks = [];
  recorder.ondataavailable = async ({ data }) => {
    if (mediaSource.readyState !== "open" || !data.size) {
      return;
    }
    sourceBuffer.appendBuffer(await data.arrayBuffer());
  };
  delayed.pause();
  recorder.start(10);
  delayed.play();
  //setTimeout(() => delayed.play(), delay);
}

function getStream() {
  return navigator.mediaDevices.getUserMedia({ video: true });
}
</script>
<div class="container">
  <section style="position:absolute;left:0px;top:0px;">
    <video id="realtime" autoplay muted controls></video>
  </section>
  <section style="position:absolute;left:0px;top:0px;">
    <video id="delayed" autoplay muted controls style="filter: opacity(50%) invert();"></video>
  </section>
</div>